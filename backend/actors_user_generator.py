'''
    Work only 1 time on Freemium RapidShare, because you will have only 500 requests/month
'''

import requests
import json
import base64
from random import random, randint, choice, choices
from database import pool
import time

url = "https://imdb8.p.rapidapi.com/actors/get-bio"

headers = {
    'x-rapidapi-key': "02dda5d6f5msh3f059e57dc1cc5dp13d3cajsn5937443feab1",
    'x-rapidapi-host': "imdb8.p.rapidapi.com"
    }

hobbies_list = ["Acting","Action figure","Aerobatics","Aeromodeling","Aid climbing","Aikido","Air hockey","Air racing","Air sports","Airbrushing","Airsoft","Alpine skiing","Amateur Radio","Angling","Animal fancy","Antiquing","Antiquities","Aqua-lung","Aquarium","Aquathlon","Archery","Arena football","Arimaa","Arm wrestling","Art collecting","Artistic pool","Arts","Astrology","Astronomy","Atlatl","Austus","Auto Race","Auto racing","Autocross","Autograss","Aviation","Axe throwing","BASE jumping","BMX","Ba game","Backgammon","Backpacking","Backstroke","Badminton","Bagatelle","Baguazhang","Balance beam","Ball","Ball badminton","Ball hockey","Bando","Bandy","Banger racing","Bank pool","Bar billiards","Barrel racing","Bartitsu","Base Jumping","Baseball","Basketball","Basque pelota","Bat and trap","Baton Twirling","Baton twirling","Battle gaming","Battōjutsu","Beach handball","Beach rugby","Beach soccer","Beachcombing","Beadwork","Beagling","Beatboxing","Beekeeping","Beer Pong","Bell Ringing","Belly Dancing","Biathlon","Bicycle Polo","Bicycle polo","Bicycling","Bird watching","Birding","Birdwatching","Biribol","Blackball","Blacksmithing","Blogging","Board games","Board sports","BoardGames","Boardercross","Boating","Bobsleigh","Bocce","Bocce volo","Boccia","Body Building","Bodyboarding","Bodybuilding","Bokator","Bolas criollas","Boli Khela","Bonsai Tree","Bookbinding","Boomerangs","Bossaball","Bottle pool","Bouldering","Boules","Bowling","Bowlliards","Bowls","Box lacrosse","Boxing","Breakdancing","Breaststroke","Brewing Beer","Broomball","Brännboll","Bucketball","Bujinkan","Bumper pool","Bungee jumping","Bunnock","Bus spotting","Butts Up","Buzkashi","Cabaret","Caid","Calligraphy","Calva","Calvinball","Cammag","Camogie","Campdrafting","Camping","Candle Making","Candle making","Canoe polo","Canoeing","Canyoning","Capoeira","Car Racing","Cartooning","Casterboarding","Casting","Cave Diving","Ceramics","Cestoball","Chariot racing","Charreada","Checkers","Cheerleading","Chess","Chess boxing","Chess960","Chicago","Chilean rodeo","Chinlone","Choi Kwang-Do","Cigar Smoking","Cirit","Climbing","Cloud Watching","Cnapan","Coasteering","Cockfighting","Collecting","Color guard","Coloring","Coloring book","Combat robot","Community","Compose Music","Connect Four","Contesting","Conworlding","Cooking","Corkball","Cornhole","Cosplay","Cosplaying","Couponing","Cowboy","Cowboy polo","Crafts","Creeking","Cribbage","Cricket","Crochet","Crocheting","Croquet","Cross-Stitch","Cryptography","Cue sports","Cuju","Curling","Cushion caroms","Cutthroat","Cutting","Cycle polo","Cycle speedway","Cycling","Cyclo-cross","Czech handball","Dance","Dancing","Darts","Debate","Decathlon","Deer hunting","Deltiology","Desert racing","Dice stacking","Die-cast toy","Digital art","Dinghy sailing","Diplomacy","Dirt jumping","Disc dog","Disc golf","Discus throw","Diving","Do it yourself","Dodge disc","Dodgeball","Dog sport","Dolls","Dominoes","Dowsing","Drag racing","Dragon boat","Drama","Draughts","Drawing","Dressage","Drifting","Driving","Duathlon","Dumog","Eating out","Eight-ball","Electronics","Elephant polo","Embroidery","Endurance","Enduro","Entertaining","Episkyros","Equestrianism","Equitation","Eskrima","Eton College","Eton Fives","Eton wall game","Eventing","Exercise","Falconry","Fashion","Fast cars","Fastnet","Felting","Fencing","Field archery","Field handball","Field hockey","Field lacrosse","Field target","Figure skating","Finswimming","Fire Poi","Fishing","Fishkeeping","Fistball","Five-pins","Fives","Flag Football","Flag football","Flight archery","Floor","Floorball","Flutterguts","Fly Tying","Fly fishing","Flyak","Flying disc","Flying trapeze","Folk wrestling","Folkrace","Footbag","Footbag net","Football","Footvolley","Foraging","Formula Libre","Formula racing","Fossil hunting","Four Wheeling","Four square","Fox hunting","Free running","Freeboard","Freeboating","Freediving","Freestyle BMX","Fricket","Futsal","Ga-ga","Gambling","Games","Garage Saleing","Gardening","Gateball","Gatka","Genealogy","Geo caching","Geocaching","Ghost Hunting","Ghost hunting","Gig racing","Glassblowing","Gliding","Glima","Glowsticking","Gnoming","Go","Go Kart Racing","Go-Moku","Goalball","Goaltimate","Golf","Gongoozler","Graffiti","Grasstrack","Grip Strength","Guitar","Gun Collecting","Gungdo","Gunsmithing","Guts","Gymkhana","Gymnastics","Gyotaku","Haggis hurling","Hala","Half marathon","Hammer throw","Handball","Hang gliding","Hapkido","Hapsagai","Hare coursing","Harness racing","Harpastum","Haxey Hood","Headis","Heptathlon","Herping","Hide and seek","High jump","Highland games","Hiking","Hillclimbing","Hockey","Hojōjutsu","Home Brewing","Home Repair","Home Theater","Homebrewing","Hoop","Hooping","Hooverball","Hopper balloon","Horizontal bar","Hornussen","Horse polo","Horse racing","Horse riding","Horseball","Horseshoe","Horseshoes","Hot box","House of cards","Hula Hooping","Human swimming","Hunter","Hunter-jumpers","Hunting","Hurdles","Hurling","Hwa Rang Do","Hybrid codes","Iaidō","Iaijutsu","Ice climbing","Ice dancing","Ice fishing","Ice hockey","Ice racing","Ice skating","Ice speedway","Ice yachting","Iceskating","Icosathlon","Illusion","Impersonations","Indoor archery","Indoor cricket","Indoor enduro","Indoor netball","Indoor soccer","Inline hockey","Inline skating","Intercrosse","Internet","Inventing","Isle of Man TT","Jacquet","Jai alai","Janggi","Javelin throw","Jeet Kune Do","Jet Engines","Jeu de paume","Jeu provençal","Jewelry Making","Jewelry making","Jigsaw Puzzles","Jigsaw puzzles","Jogging","Jogo do pau","Jorkyball","Jousting","Judo","Jugger","Juggling","Juggling club","Jujutsu","Jukskei","Jump Roping","Jump rope","Jumping","Juttejutsu","Jōdō","Jūkendō","Kabaddi","Kajukenbo","Kalarippayattu","Karate","Kart racing","Kayaking","Keep A Journal","Keep away","Keepie uppie","Kelly pool","Kemari","Kendo","Kenjutsu","Kenpō","Kho kho","Ki-o-rahi","Kick the can","Kickball","Kickboxing","Kilikiti","Killer","Kin-Ball","Kinomichi","Kite","Kite Boarding","Kite buggy","Kite fighting","Kite flying","Kites","Kitesurfing","Knapping","Knattleikr","Kneeboarding","Knife making","Knife throwing","Knitting","Knotting","Kombucha","Korfball","Krabi-krabong","Krav Maga","Kronum","Kubb","Kuk Sool Won","Kumdo","Kurash","Kyūdō","Kyūjutsu","LARPing","La soule","Lace","Lacrosse","Land sailing","Lapidary club","Lapta","Laser tag","Lasers","Lawn Darts","Learning","Lego","Legos","Lelo burti","Lethwei","Letterboxing","Lockpicking","Locksport","Logrolling","Long jump","Longboarding","Losing chess","Luge","Lumberjack","MCMAP","Machining","Macrame","Macramé","Magic","Mahjong","Malla-yuddha","Mancala","Marathon","Marbles","Marching band","Marksmanship","Marn Grook","Martial Arts","Martial arts","Matball","Match play","Meditation","Megaminx","Metal detector","Metalworking","Meteorology","Metro footy","Microscopy","Mini footy","Mini rugby","Miniature golf","Mixed climbing","Mob football","Mod league","Model Rockets","Model aircraft","Model building","Model yachting","Modeling Ships","Models","Modern Arnis","Monster truck","Motocross","Motor sports","Motorcycles","Mountaineering","Movies","Muay Thai","Mud bogging","Music","Naginatajutsu","Nail Art","Needlepoint","Neppis","Netball","Newcomb ball","Nine-ball","Ninjutsu","Noodling","Nordic skating","Nordic skiing","Novuss","Off-roading","Oina","Old cat","One-pocket","Orienteering","Origami","Other","Over-the-line","Oztag","Padiddling","Paintball","Painting","Palant","Pall mall","Palla","Pankration","Papermache","Papermaking","Papi fut","Parachuting","Paragliding","Parallel bars","Paramotoring","Parasailing","Parkour","Patball","Pato","Pehlwani","Pencak Silat","Pentathlon","Pesäpallo","Pet","Peteca","Photography","Piano","Pickleball","Pigeon racing","Pinochle","Pipe Smoking","Pitch and putt","Planking","Plate spinning","Playing music","Pocket Cube","Poi","Poker","Pole Dancing","Pole climbing","Pole vault","Polo","Polocrosse","Pommel horse","Pond hockey","Popinjay","Pottery","Power hockey","Powerbocking","Powerboking","Powerlifting","Pradal serey","Protesting","Punchball","Puppetry","Puzzle","Pyraminx","Pyrotechnics","Pétanque","Quidditch","Quilting","Quizzing","R/C Boats","R/C Cars","R/C Planes","Racewalking","Racing Pigeons","Racquetball","Radio control","Rafting","Railfans","Rally raid","Rallycross","Rallying","Rappelling","Rapping","Reading","Rec footy","Red rover","Reining","Relaxing","Renting movies","Reversi","Ribbon","Ringball","Ringette","Ringo","Rings","Rink bandy","Rink hockey","Rinkball","Risk","Riverboarding","Road racing","Road running","Robot combat","Robotics","Rock Balancing","Rock balancing","Rock climbing","Rock fishing","Rockets","Rodeo","Rogaining","Roleplaying","Roller derby","Roller hockey","Roller skating","Rope","Rope climbing","Rossall Hockey","Rotation","Rounders","Rowing","Royak","Rubik's Clock","Rubik's Cube","Rugby Fives","Rugby football","Rugby league","Rugby sevens","Rugby tens","Rugby union","Rundown","Running","Sack race","Sailing","Sambo","Samoa rules","San shou","Sand Castles","Sandboarding","Sanshou","Savate","Schwingen","Scouting","Scrabble","Scrapbooking","Scrub baseball","Scuba Diving","Scuba diving","Sculling","Sculpting","Sea glass","Sea kayaking","Seashell","Segway polo","Self Defense","Sepak takraw","Seven-ball","Sewing","Shark Fishing","Shinty","Shogi","Sholo Guti","Shoot boxing","Shootfighting","Shooting","Shooting sport","Shopping","Shorinji Kempo","Shot put","Shotgun start","Show jumping","Shuai Jiao","Shuffleboard","Shurikenjutsu","Sikaran","Silambam","Silat","Singing","Single scull","Sipa","Skateboarding","Skater hockey","Skee ball","Skeet Shooting","Skeet shooting","Skeleton","Sketch","Sketching","Skewb","Ski flying","Ski jumping","Ski touring","Skiboarding","Skibob","Skibobbing","Skiing","Skijoring","Skimboarding","Skins game","Skittles","Sky Diving","Skydiving","Skysurfing","Slack Lining","Slacklining","Slamball","Sleeping","Slingshots","Snail racing","Snooker","Snooker plus","Snorkeling","Snorkelling","Snow kiting","Snow rugby","Snowboarding","Snowkiting","Snowmobile","Snowshoeing","Soap Making","Soap shoes","Soapmaking","Soccer","Softball","Sogo","Spearfishing","Speed Cubing","Speed golf","Speed pool","Speed skating","Speed skiing","Speedball","Speedcubing","Spelunkering","Spongee","Sport climbing","Sport diving","Sport fishing","Sport kite","Sport stacking","Sporting clays","Sprint","Square","Squash","Squash tennis","Squirt boating","Ssireum","Static trapeze","Steeplechase","Steinstossen","Stickball","Stone skipping","Stool ball","Storm Chasing","Storytelling","Straight pool","Stratego","Street hockey","Street racing","Streetball","Streetboarding","Streetluge","String Figures","Stroke play","Strongman","Subak","Subbuteo","Sudoku","Suicide","Sumo","Super sport","Supercross","Supermoto","Superside","Surf Fishing","Surf fishing","Surf kayaking","Surfboat","Surfing","Survival","Swamp football","Swimming","Sword fighting","Systema","Sōjutsu","TV watching","Table football","Table tennis","Taekkyeon","Taekwondo","Tag","Tag rugby","Tai chi","Taido","Tang Soo Do","Target archery","Tatting","Taxidermy","Tchoukball","Tea Tasting","Team penning","Team play","Team sport","Tee-ball","Ten-ball","Tennikoit","Tennis","Tennis polo","Tent pegging","Tesla Coils","Test cricket","Tetherball","Tetris","Textiles","Texting","Three-ball","Three-cushion","Throwball","Throwing","Time attack","Toboggan","Toe wrestling","Topiary","Torball","Toss juggling","Touch football","Touch rugby","Tour skating","Tower running","Town ball","Toy Collecting","Track cycling","Track racing","Train Spotting","Trainspotting","Trampolining","Trap shooting","Trapeze","Traveling","Trekkie","Trial","Triathlon","Trick shot","Triple jump","Trophy hunting","Truck racing","Trugo","Tug-o-war","Tumbling","Twenty20","Ultimate","Ultimate Disc","Ultramarathon","Uneven bars","Unicycling","V-Cube 6","V-Cube 7","Vacation","Vajra-mushti","Vale tudo","Vault","Video Games","Video game","Video gaming","Videophile","Vigoro","Vintage cars","Violin","Volata","Volleyball","Volunteer","Vovinam","Waboba","Wakeboarding","Wakesurfing","Walking","Wallball","Wallyball","Warhammer","Water polo","Water sports","Waymarking","Web surfing","Weightlifting","Whale Watching","Whittling","Wiffleball","Windsurfing","Wine Making","Wing Chun","Wireball","Woggabaliri","Wolf hunting","Wood carving","Wood chopping","Wood splitting","Woodball","Woodsman","Woodworking","Worldbuilding","Wrestling","Writing","YoYo","Yoga","Yubi lakpi","Yukigassen","Ziplining","Zourkhaneh","Zui quan","Zumba"]

pool.init()

connection = pool.get_conn()

current_id = 1

while current_id < 500:
    try:
        actorid = "nm0000" + str(randint(101, 999))
        querystring = {"nconst":actorid}
        response = requests.request("GET", url, headers=headers, params=querystring)
        result = response.json()
        # User Info Generate
        name = result["name"].split(" ")
        fname = name[0]
        lname = name[1] if len(name) > 1 else name[0]
        email = fname + "@" + lname + ".com"
        email_verified = 1
        username = fname + lname + str(randint(0, 9999))
        passhash = "Generateduserpasshash123"
        bio = "I was born at " + result["birthPlace"]
        gender = result["gender"]
        dob = result["birthDate"]
        latitude= round(55 + random(), 8)
        longitude = round(37 + random(), 8)
        preferences = ["female"] if gender == "male" else ["male"]
        interests = choices(hobbies_list, k=randint(2,10))

        # Image Downloading
        img_url = result["image"]["url"]
        img_response = requests.get(img_url)
        img_type = img_url.split(".")[-1]
        image64 = base64.b64encode(response.content).decode("utf-8")

        with connection.cursor() as c:
            c.execute("""INSERT INTO users 
                (fname, lname, email, email_verified, username, passhash, bio, gender, dob, latitude, longitude, preferences, interests)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                """, (
                    fname, lname, email, email_verified, 
                    username, passhash, bio, gender, dob, latitude, longitude, 
                    ",".join(preferences), ",".join(interests)
                ))
            c.execute("""INSERT INTO images (user_id, is_primary, image_type, image64)
                VALUES (%s, %s, %s, %s)
            """, (current_id, 1, img_type, image64))
        current_id += 1
        if current_id % 3 == 0:
            time.sleep(1)
        print("Added " + current_id + " : " + email)
    except:
        continue

print("Added " + current_id + " Users")
pool.release(connection)