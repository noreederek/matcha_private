'''
    Generating users with RandomUser API and RonSwansonQuotes API
'''
from database import pool
from datetime import datetime
from random import random, randint, choice, choices
import base64
import requests

hobbies_list = ["Acting","Action figure","Aerobatics","Aeromodeling","Aid climbing","Aikido","Air hockey","Air racing","Air sports","Airbrushing","Airsoft","Alpine skiing","Amateur Radio","Angling","Animal fancy","Antiquing","Antiquities","Aqua-lung","Aquarium","Aquathlon","Archery","Arena football","Arimaa","Arm wrestling","Art collecting","Artistic pool","Arts","Astrology","Astronomy","Atlatl","Austus","Auto Race","Auto racing","Autocross","Autograss","Aviation","Axe throwing","BASE jumping","BMX","Ba game","Backgammon","Backpacking","Backstroke","Badminton","Bagatelle","Baguazhang","Balance beam","Ball","Ball badminton","Ball hockey","Bando","Bandy","Banger racing","Bank pool","Bar billiards","Barrel racing","Bartitsu","Base Jumping","Baseball","Basketball","Basque pelota","Bat and trap","Baton Twirling","Baton twirling","Battle gaming","Battōjutsu","Beach handball","Beach rugby","Beach soccer","Beachcombing","Beadwork","Beagling","Beatboxing","Beekeeping","Beer Pong","Bell Ringing","Belly Dancing","Biathlon","Bicycle Polo","Bicycle polo","Bicycling","Bird watching","Birding","Birdwatching","Biribol","Blackball","Blacksmithing","Blogging","Board games","Board sports","BoardGames","Boardercross","Boating","Bobsleigh","Bocce","Bocce volo","Boccia","Body Building","Bodyboarding","Bodybuilding","Bokator","Bolas criollas","Boli Khela","Bonsai Tree","Bookbinding","Boomerangs","Bossaball","Bottle pool","Bouldering","Boules","Bowling","Bowlliards","Bowls","Box lacrosse","Boxing","Breakdancing","Breaststroke","Brewing Beer","Broomball","Brännboll","Bucketball","Bujinkan","Bumper pool","Bungee jumping","Bunnock","Bus spotting","Butts Up","Buzkashi","Cabaret","Caid","Calligraphy","Calva","Calvinball","Cammag","Camogie","Campdrafting","Camping","Candle Making","Candle making","Canoe polo","Canoeing","Canyoning","Capoeira","Car Racing","Cartooning","Casterboarding","Casting","Cave Diving","Ceramics","Cestoball","Chariot racing","Charreada","Checkers","Cheerleading","Chess","Chess boxing","Chess960","Chicago","Chilean rodeo","Chinlone","Choi Kwang-Do","Cigar Smoking","Cirit","Climbing","Cloud Watching","Cnapan","Coasteering","Cockfighting","Collecting","Color guard","Coloring","Coloring book","Combat robot","Community","Compose Music","Connect Four","Contesting","Conworlding","Cooking","Corkball","Cornhole","Cosplay","Cosplaying","Couponing","Cowboy","Cowboy polo","Crafts","Creeking","Cribbage","Cricket","Crochet","Crocheting","Croquet","Cross-Stitch","Cryptography","Cue sports","Cuju","Curling","Cushion caroms","Cutthroat","Cutting","Cycle polo","Cycle speedway","Cycling","Cyclo-cross","Czech handball","Dance","Dancing","Darts","Debate","Decathlon","Deer hunting","Deltiology","Desert racing","Dice stacking","Die-cast toy","Digital art","Dinghy sailing","Diplomacy","Dirt jumping","Disc dog","Disc golf","Discus throw","Diving","Do it yourself","Dodge disc","Dodgeball","Dog sport","Dolls","Dominoes","Dowsing","Drag racing","Dragon boat","Drama","Draughts","Drawing","Dressage","Drifting","Driving","Duathlon","Dumog","Eating out","Eight-ball","Electronics","Elephant polo","Embroidery","Endurance","Enduro","Entertaining","Episkyros","Equestrianism","Equitation","Eskrima","Eton College","Eton Fives","Eton wall game","Eventing","Exercise","Falconry","Fashion","Fast cars","Fastnet","Felting","Fencing","Field archery","Field handball","Field hockey","Field lacrosse","Field target","Figure skating","Finswimming","Fire Poi","Fishing","Fishkeeping","Fistball","Five-pins","Fives","Flag Football","Flag football","Flight archery","Floor","Floorball","Flutterguts","Fly Tying","Fly fishing","Flyak","Flying disc","Flying trapeze","Folk wrestling","Folkrace","Footbag","Footbag net","Football","Footvolley","Foraging","Formula Libre","Formula racing","Fossil hunting","Four Wheeling","Four square","Fox hunting","Free running","Freeboard","Freeboating","Freediving","Freestyle BMX","Fricket","Futsal","Ga-ga","Gambling","Games","Garage Saleing","Gardening","Gateball","Gatka","Genealogy","Geo caching","Geocaching","Ghost Hunting","Ghost hunting","Gig racing","Glassblowing","Gliding","Glima","Glowsticking","Gnoming","Go","Go Kart Racing","Go-Moku","Goalball","Goaltimate","Golf","Gongoozler","Graffiti","Grasstrack","Grip Strength","Guitar","Gun Collecting","Gungdo","Gunsmithing","Guts","Gymkhana","Gymnastics","Gyotaku","Haggis hurling","Hala","Half marathon","Hammer throw","Handball","Hang gliding","Hapkido","Hapsagai","Hare coursing","Harness racing","Harpastum","Haxey Hood","Headis","Heptathlon","Herping","Hide and seek","High jump","Highland games","Hiking","Hillclimbing","Hockey","Hojōjutsu","Home Brewing","Home Repair","Home Theater","Homebrewing","Hoop","Hooping","Hooverball","Hopper balloon","Horizontal bar","Hornussen","Horse polo","Horse racing","Horse riding","Horseball","Horseshoe","Horseshoes","Hot box","House of cards","Hula Hooping","Human swimming","Hunter","Hunter-jumpers","Hunting","Hurdles","Hurling","Hwa Rang Do","Hybrid codes","Iaidō","Iaijutsu","Ice climbing","Ice dancing","Ice fishing","Ice hockey","Ice racing","Ice skating","Ice speedway","Ice yachting","Iceskating","Icosathlon","Illusion","Impersonations","Indoor archery","Indoor cricket","Indoor enduro","Indoor netball","Indoor soccer","Inline hockey","Inline skating","Intercrosse","Internet","Inventing","Isle of Man TT","Jacquet","Jai alai","Janggi","Javelin throw","Jeet Kune Do","Jet Engines","Jeu de paume","Jeu provençal","Jewelry Making","Jewelry making","Jigsaw Puzzles","Jigsaw puzzles","Jogging","Jogo do pau","Jorkyball","Jousting","Judo","Jugger","Juggling","Juggling club","Jujutsu","Jukskei","Jump Roping","Jump rope","Jumping","Juttejutsu","Jōdō","Jūkendō","Kabaddi","Kajukenbo","Kalarippayattu","Karate","Kart racing","Kayaking","Keep A Journal","Keep away","Keepie uppie","Kelly pool","Kemari","Kendo","Kenjutsu","Kenpō","Kho kho","Ki-o-rahi","Kick the can","Kickball","Kickboxing","Kilikiti","Killer","Kin-Ball","Kinomichi","Kite","Kite Boarding","Kite buggy","Kite fighting","Kite flying","Kites","Kitesurfing","Knapping","Knattleikr","Kneeboarding","Knife making","Knife throwing","Knitting","Knotting","Kombucha","Korfball","Krabi-krabong","Krav Maga","Kronum","Kubb","Kuk Sool Won","Kumdo","Kurash","Kyūdō","Kyūjutsu","LARPing","La soule","Lace","Lacrosse","Land sailing","Lapidary club","Lapta","Laser tag","Lasers","Lawn Darts","Learning","Lego","Legos","Lelo burti","Lethwei","Letterboxing","Lockpicking","Locksport","Logrolling","Long jump","Longboarding","Losing chess","Luge","Lumberjack","MCMAP","Machining","Macrame","Macramé","Magic","Mahjong","Malla-yuddha","Mancala","Marathon","Marbles","Marching band","Marksmanship","Marn Grook","Martial Arts","Martial arts","Matball","Match play","Meditation","Megaminx","Metal detector","Metalworking","Meteorology","Metro footy","Microscopy","Mini footy","Mini rugby","Miniature golf","Mixed climbing","Mob football","Mod league","Model Rockets","Model aircraft","Model building","Model yachting","Modeling Ships","Models","Modern Arnis","Monster truck","Motocross","Motor sports","Motorcycles","Mountaineering","Movies","Muay Thai","Mud bogging","Music","Naginatajutsu","Nail Art","Needlepoint","Neppis","Netball","Newcomb ball","Nine-ball","Ninjutsu","Noodling","Nordic skating","Nordic skiing","Novuss","Off-roading","Oina","Old cat","One-pocket","Orienteering","Origami","Other","Over-the-line","Oztag","Padiddling","Paintball","Painting","Palant","Pall mall","Palla","Pankration","Papermache","Papermaking","Papi fut","Parachuting","Paragliding","Parallel bars","Paramotoring","Parasailing","Parkour","Patball","Pato","Pehlwani","Pencak Silat","Pentathlon","Pesäpallo","Pet","Peteca","Photography","Piano","Pickleball","Pigeon racing","Pinochle","Pipe Smoking","Pitch and putt","Planking","Plate spinning","Playing music","Pocket Cube","Poi","Poker","Pole Dancing","Pole climbing","Pole vault","Polo","Polocrosse","Pommel horse","Pond hockey","Popinjay","Pottery","Power hockey","Powerbocking","Powerboking","Powerlifting","Pradal serey","Protesting","Punchball","Puppetry","Puzzle","Pyraminx","Pyrotechnics","Pétanque","Quidditch","Quilting","Quizzing","R/C Boats","R/C Cars","R/C Planes","Racewalking","Racing Pigeons","Racquetball","Radio control","Rafting","Railfans","Rally raid","Rallycross","Rallying","Rappelling","Rapping","Reading","Rec footy","Red rover","Reining","Relaxing","Renting movies","Reversi","Ribbon","Ringball","Ringette","Ringo","Rings","Rink bandy","Rink hockey","Rinkball","Risk","Riverboarding","Road racing","Road running","Robot combat","Robotics","Rock Balancing","Rock balancing","Rock climbing","Rock fishing","Rockets","Rodeo","Rogaining","Roleplaying","Roller derby","Roller hockey","Roller skating","Rope","Rope climbing","Rossall Hockey","Rotation","Rounders","Rowing","Royak","Rubik's Clock","Rubik's Cube","Rugby Fives","Rugby football","Rugby league","Rugby sevens","Rugby tens","Rugby union","Rundown","Running","Sack race","Sailing","Sambo","Samoa rules","San shou","Sand Castles","Sandboarding","Sanshou","Savate","Schwingen","Scouting","Scrabble","Scrapbooking","Scrub baseball","Scuba Diving","Scuba diving","Sculling","Sculpting","Sea glass","Sea kayaking","Seashell","Segway polo","Self Defense","Sepak takraw","Seven-ball","Sewing","Shark Fishing","Shinty","Shogi","Sholo Guti","Shoot boxing","Shootfighting","Shooting","Shooting sport","Shopping","Shorinji Kempo","Shot put","Shotgun start","Show jumping","Shuai Jiao","Shuffleboard","Shurikenjutsu","Sikaran","Silambam","Silat","Singing","Single scull","Sipa","Skateboarding","Skater hockey","Skee ball","Skeet Shooting","Skeet shooting","Skeleton","Sketch","Sketching","Skewb","Ski flying","Ski jumping","Ski touring","Skiboarding","Skibob","Skibobbing","Skiing","Skijoring","Skimboarding","Skins game","Skittles","Sky Diving","Skydiving","Skysurfing","Slack Lining","Slacklining","Slamball","Sleeping","Slingshots","Snail racing","Snooker","Snooker plus","Snorkeling","Snorkelling","Snow kiting","Snow rugby","Snowboarding","Snowkiting","Snowmobile","Snowshoeing","Soap Making","Soap shoes","Soapmaking","Soccer","Softball","Sogo","Spearfishing","Speed Cubing","Speed golf","Speed pool","Speed skating","Speed skiing","Speedball","Speedcubing","Spelunkering","Spongee","Sport climbing","Sport diving","Sport fishing","Sport kite","Sport stacking","Sporting clays","Sprint","Square","Squash","Squash tennis","Squirt boating","Ssireum","Static trapeze","Steeplechase","Steinstossen","Stickball","Stone skipping","Stool ball","Storm Chasing","Storytelling","Straight pool","Stratego","Street hockey","Street racing","Streetball","Streetboarding","Streetluge","String Figures","Stroke play","Strongman","Subak","Subbuteo","Sudoku","Suicide","Sumo","Super sport","Supercross","Supermoto","Superside","Surf Fishing","Surf fishing","Surf kayaking","Surfboat","Surfing","Survival","Swamp football","Swimming","Sword fighting","Systema","Sōjutsu","TV watching","Table football","Table tennis","Taekkyeon","Taekwondo","Tag","Tag rugby","Tai chi","Taido","Tang Soo Do","Target archery","Tatting","Taxidermy","Tchoukball","Tea Tasting","Team penning","Team play","Team sport","Tee-ball","Ten-ball","Tennikoit","Tennis","Tennis polo","Tent pegging","Tesla Coils","Test cricket","Tetherball","Tetris","Textiles","Texting","Three-ball","Three-cushion","Throwball","Throwing","Time attack","Toboggan","Toe wrestling","Topiary","Torball","Toss juggling","Touch football","Touch rugby","Tour skating","Tower running","Town ball","Toy Collecting","Track cycling","Track racing","Train Spotting","Trainspotting","Trampolining","Trap shooting","Trapeze","Traveling","Trekkie","Trial","Triathlon","Trick shot","Triple jump","Trophy hunting","Truck racing","Trugo","Tug-o-war","Tumbling","Twenty20","Ultimate","Ultimate Disc","Ultramarathon","Uneven bars","Unicycling","V-Cube 6","V-Cube 7","Vacation","Vajra-mushti","Vale tudo","Vault","Video Games","Video game","Video gaming","Videophile","Vigoro","Vintage cars","Violin","Volata","Volleyball","Volunteer","Vovinam","Waboba","Wakeboarding","Wakesurfing","Walking","Wallball","Wallyball","Warhammer","Water polo","Water sports","Waymarking","Web surfing","Weightlifting","Whale Watching","Whittling","Wiffleball","Windsurfing","Wine Making","Wing Chun","Wireball","Woggabaliri","Wolf hunting","Wood carving","Wood chopping","Wood splitting","Woodball","Woodsman","Woodworking","Worldbuilding","Wrestling","Writing","YoYo","Yoga","Yubi lakpi","Yukigassen","Ziplining","Zourkhaneh","Zui quan","Zumba"]

ronswansonquotes = ["One rage every three months is permitted. Try not to hurt anyone who doesn't deserve it.","I've had the same will since I was 8 years old. Upon my death, I will transfer all of my belongings to the man or animal who has killed me.","Under my tutelage, you will grow from boys to men. From men into gladiators. And from gladiators into Swansons.","You had me at meat tornado.","I hate everything.","Cultivating a manly musk puts opponent on notice.","Capitalism is the only way … It makes America great, England OK and France terrible.","Tom put all my records into this rectangle!","My son is several weeks old. He is very familiar with the sound of power tools.","No home is complete without a proper toolbox. Here's April and Andy's: A hammer, a half eaten pretzel, a baseball card, some cartridge that says Sonic and Hedgehog, a scissor half, a flashlight filled with jellybeans.","I believe in cutting useless government projects. I also believe in cutting useful government projects.","Normally, if given the choice between doing something and nothing, I’d choose to do nothing. But I will do something if it helps someone else do nothing. I’d work all night, if it meant nothing got done.","Never half-ass two things. Whole-ass one thing.","The key to burning an ex-wife effigy is to dip it in paraffin wax and then toss the flaming bottle of isopropyl alcohol from a safe distance. Do not stand too close when you light an ex-wife effigy.","Capitalism: God's way of determining who is smart and who is poor.","Birthdays were invented by Hallmark to sell cards.","Give 100%. 110 is impossible. Only idiots recommend that.","I like some changes. Like when I change a tree into a canoe, or a wife into an ex-wife.","I like saying ‘No,’ it lowers their enthusiasm.","On nights like this when the cold winds blow, the air is awash in the swirling eddies of our dream, come with me and find safe haven in a warm bathtub full of my jazz.","Go back to the library where you belong.","I don't want to paint with a broad brush here, but every single contractor in the world is a miserable, incompetent thief.","Fishing relaxes me. It's like yoga, except I still get to kill something.","Are you going to tell a man that he can't fart in his own car?","I was born ready. I’m Ron F*cking Swanson.","Every two weeks I need to sand down my toe nails. They're too strong for clippers.","I wanna punch you in the face so bad right now.","An hour ago a giant fireball consumed my entire face and it was far preferable to spending another second with you.","Well, I am not usually one for speeches. So, goodbye.","I will leave my children $50 a piece. Enough for the cab ride home from the funeral and a steak dinner. End of discussion.","There are three acceptable haircuts: high and tight, crew cut, buzz cut.","When I eat, it is the food that is scared.","Barbecues should be about one thing: good shared meat.","If any of you need anything at all, too bad. Deal with your problems yourselves, like adults.","Friends: one to three is sufficient.","There has never been a sadness that can’t been cured by breakfast food.","History began July 4th, 1776. Anything before that was a mistake.","What's cholesterol?","I'm going to get 12 eggs and part of a dead animal. Dealer's choice. Please and thank you.","People who buy things are suckers.","The three most useless jobs in the world in order are: lawyer, congressman, and doctor.","I love riddles!","Clear alcohols are for rich women on diets.","Say what you want about organized religion, but those bastards knew how to construct an edifice.","An ideal night out, to me, is stepping onto my porch area and grilling up a thick slab of something’s flesh and then popping in a highlight real from the WNBA.","It’s pointless for a human to paint scenes of nature when they can go outside and stand in it.","Standard birth control methods are usually ineffective against a Swanson.","There is only one bad word: taxes.","Please and thank you.","Veganism is the sad result of a morally corrupt mind. Reconsider your life.","America: The only country that matters. If you want to experience other ‘cultures,’ use an atlas or a ham radio.","Son, there is no wrong way to consume alcohol.","I believe luck is a concept invented by the weak to explain their failures.","I enjoy government functions like I enjoy getting kicked in the nuggets with a steel toed boot.","When I'm done eating a Mulligan's meal, for weeks afterwards, there are flecks of meat in my mustache. And I refuse to clean it because every now and then a piece of meat will fall into my mouth.","In my opinion, not enough people have looked their dinner in the eyes and considered the circle of life.","There must be a mistake, you've accidentally given me the food that my food eats.","My first ex-wife’s name is Tammy. My second ex-wife’s name is Tammy. My Mom’s name is Tamara…she goes by Tammy.","Creativity is for people with glasses who like to lie.","Great job, everyone. The reception will be held in each of our individual houses, alone.","It's always a good idea to demonstrate to your coworkers that you are capable of withstanding a tremendous amount of pain.","I love nothing.","Do you have any history of mental illness in your family? I have an uncle who does yoga.","Once a year, every branch of this government meets in a room and announces what they intend to waste taxpayer money on.","There are only three ways to motivate people: money, fear, and hunger.","I like Tom. He doesn’t do a lot of work around here. He shows zero initiative. He’s not a team player. He’s never wanted to go that extra mile. Tom is exactly what I’m looking for in a government employee.","Fish, for sport only, not for meat. Fish meat is practically a vegetable.","Give a man a fish and feed him for a day. Don't teach a man to fish… and feed yourself. He's a grown man. And fishing's not that hard.","Honor: if you need it defined, you don't have it.","Crying: acceptable at funerals and the Grand Canyon.","The whole point of this country is if you want to eat garbage, balloon up to 600 pounds and die of a heart attack at 43, you can! You are free to do so. To me, that’s beautiful.","I leave no meat behind. It’s an honor thing.","Any dog under fifty pounds is a cat and cats are useless.","Is Star Wars the one with the wizard boy?","If there were more food and fewer people, this would be a perfect party.","On my deathbed, my final wish is to have my ex-wives rush to my side so I can use my dying breath to tell them both to go to hell one last time.","I've never been hungover. After I've had too much whiskey, I cook myself a large flank steak, pan fried and salted butter. I eat that, put on a pair of wet socks and go to sleep.","It's an impossible puzzle, and I love puzzles!","First rule. No conversation lasts longer than 100 total words.","Child labor laws are ruining this country.","I'll take that steak to go. Please and thank you.","I've cried twice in my life. Once when I was seven and hit by a school bus. And then again when I heard that Li'l Sebastian has passed.","Put some alcohol in your mouth to block with words from coming out.","Just give me all the bacon and eggs you have. Wait...wait. I worry what you just heard was: Give me a lot of bacon and eggs. What I said was: Give me all the bacon and eggs you have. Do you understand?","[On bowling] Straight down the middle. No hook, no spin, no fuss. Anything more and this becomes figure skating.","We have one activity planned: not getting killed.","I call this turf ‘n’ turf. It's a 16 oz T-bone and a 24 oz porterhouse. Also, whiskey and a cigar. I am going to consume all of this at the same time because I am a free American.","Shorts over six inches are capri pants, shorts under six inches are European.","Sting like a bee. Do not float like a butterfly. That’s ridiculous.","When people get a little too chummy with me I like to call them by the wrong name to let them know I don't really care about them.","I regret nothing. The end.","Dear frozen yogurt, you are the celery of desserts. Be ice cream or be nothing. Zero stars.","Don’t start chasing applause and acclaim. That way lies madness.","Keep your tears in your eyes where they belong.","I'm a simple man. I like pretty, dark-haired women, and breakfast food.","My only official recommendations are US Army-issued mustache trimmers, Morton's Salt, and the C.R. Lawrence Fein two inch axe-style scraper oscillating knife blade.","Don't waste energy moving unless necessary.","Breakfast food can serve many purposes.","Turkey can never beat cow.","I’ve had the same haircut since 1978 and I’ve driven the same car since 1991. I’ve used the same wooden comb for three decades."]

pool.init()

connection = pool.get_conn()

current_id = 1

r = requests.get("https://randomuser.me/api/?nat=gb,us&results=500")

for user in r.json()["results"]:
    fname = user["name"]["first"]
    lname = user["name"]["last"]
    print(f"Adding {fname} {lname}")
    email = user["email"].split("@")
    email_part1 = email[0] + str(randint(0, 9999))
    email_part2 = email[0]
    email = email_part1 + "@" + email_part2
    email_verified = 1
    username = user["login"]["username"] + str(randint(0, 9999))
    passhash = "Generateduserpasshash123"
    bio = choice(ronswansonquotes)
    gender = user["gender"]
    dob = user["dob"]["date"][:-14]
    latitude= round(55 + random(), 8)
    longitude = round(37 + random(), 8)
    preferences = ["female"] if gender == "male" else ["male"]
    interests = choices(hobbies_list, k=randint(2,10))
    
    # Image Downloading
    img_url = user["picture"]["large"]
    response = requests.get(img_url)
    img_type = img_url.split(".")[-1]
    image64 = base64.b64encode(response.content).decode("utf-8")

    with connection.cursor() as c:
        c.execute("""INSERT INTO users 
            (fname, lname, email, email_verified, username, passhash, bio, gender, dob, latitude, longitude, preferences, interests)
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
            """, (
                fname, lname, email, email_verified, 
                username, passhash, bio, gender, dob, latitude, longitude, 
                ",".join(preferences), ",".join(interests)
            ))
        c.execute("""INSERT INTO images (user_id, is_primary, image_type, image64)
            VALUES (%s, %s, %s, %s)
        """, (current_id, 1, img_type, image64))

    current_id += 1

pool.release(connection)



