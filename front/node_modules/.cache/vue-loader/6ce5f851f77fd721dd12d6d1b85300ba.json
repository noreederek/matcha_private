{"remainingRequest":"/goinfre/nderek/matcha_private/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/goinfre/nderek/matcha_private/front/src/components/ChangePassword.vue?vue&type=script&lang=js&","dependencies":[{"path":"/goinfre/nderek/matcha_private/front/src/components/ChangePassword.vue","mtime":1605306440448},{"path":"/goinfre/nderek/matcha_private/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/goinfre/nderek/matcha_private/front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/goinfre/nderek/matcha_private/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/goinfre/nderek/matcha_private/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQge3N0YXRlfSBmcm9tICJAL3N0b3JlIgoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgY29kZTogbnVsbCwKICAgICAgbmV3X3Bhc3N3b3JkOiBudWxsLAogICAgICBvbGRfcGFzc3dvcmQ6IG51bGwsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgcmVzZXRQYXNzd29yZDogZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmNvZGUpIHsKICAgICAgICB0aGlzLnJlc2V0UGFzc3dvcmR3aXRoQ29kZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucmVzZXRQYXNzd29yZHdpdGhQYXNzd29yZCgpOwogICAgICB9CiAgICB9LAogICAgcmVzZXRQYXNzd29yZHdpdGhDb2RlOiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy4kaHR0cAogICAgICAgIC5wdXQoYCR7dGhpcy4kYXBpfS9yZXNldC1wYXNzd29yZGAsIHsKICAgICAgICAgIGNvZGU6IHRoaXMuY29kZSwKICAgICAgICAgIG5ld19wYXNzd29yZDogdGhpcy5uZXdfcGFzc3dvcmQsCiAgICAgICAgfSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KCJQYXNzd29yZCBzdWNjZXNzZnVsbHkgcmVzZXQiLCB7CiAgICAgICAgICAgIHRpdGxlOiAiU3VjY2VzcyEiLAogICAgICAgICAgICBhdXRvSGlkZURlbGF5OiA1MDAwLAogICAgICAgICAgICB0b2FzdGVyOiAiYi10b2FzdGVyLXRvcC1jZW50ZXIiLAogICAgICAgICAgICB2YXJpYW50OiAiaW5mbyIsCiAgICAgICAgICAgIG5vQ2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgICAgfSk7CgogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvbG9naW4iKTsKICAgICAgICAgIH0sIDMwMDApOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoCiAgICAgICAgICAgICJVbmFibGUgdG8gcmVzZXQgcGFzc3dvcmQuIEVycm9yOiAiICsgZXJyLnJlc3BvbnNlLmRhdGEubWVzc2FnZSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHRpdGxlOiAiRXJyb3IhIiwKICAgICAgICAgICAgICBhdXRvSGlkZURlbGF5OiA1MDAwLAogICAgICAgICAgICAgIHRvYXN0ZXI6ICJiLXRvYXN0ZXItdG9wLWNlbnRlciIsCiAgICAgICAgICAgICAgdmFyaWFudDogIndhcm5pbmciLAogICAgICAgICAgICAgIG5vQ2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgICAgICB9CiAgICAgICAgICApOwoKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiLyIpOwogICAgICAgICAgfSwgMzAwMCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgcmVzZXRQYXNzd29yZHdpdGhQYXNzd29yZDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuJGh0dHAKICAgICAgICAucHV0KGAke3RoaXMuJGFwaX0vcmVzZXQtcGFzc3dvcmRgLCB7CiAgICAgICAgICBwcmV2aW91c19wYXNzd29yZDogdGhpcy5vbGRfcGFzc3dvcmQsCiAgICAgICAgICBuZXdfcGFzc3dvcmQ6IHRoaXMubmV3X3Bhc3N3b3JkLAogICAgICAgICAgdXNlcl9pZDogc3RhdGUudXNlci5pZCwKICAgICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMubmV3X3Bhc3N3b3JkID0gbnVsbDsKICAgICAgICAgIHRoaXMub2xkX3Bhc3N3b3JkID0gbnVsbDsKICAgICAgICAgIHRoaXMuJGJ2VG9hc3QudG9hc3QoIlBhc3N3b3JkIHN1Y2Nlc3NmdWxseSBjaGFuZ2VkLiIsIHsKICAgICAgICAgICAgdGl0bGU6ICJTdWNjZXNzISIsCiAgICAgICAgICAgIGF1dG9IaWRlRGVsYXk6IDUwMDAsCiAgICAgICAgICAgIHRvYXN0ZXI6ICJiLXRvYXN0ZXItdG9wLWNlbnRlciIsCiAgICAgICAgICAgIHZhcmlhbnQ6ICJzdWNjZXNzIiwKICAgICAgICAgICAgbm9DbG9zZUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB9KTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICB0aGlzLiRidlRvYXN0LnRvYXN0KAogICAgICAgICAgICAiVW5hYmxlIHRvIHJlc2V0IHBhc3N3b3JkLiBFcnJvcjogIiArIGVyci5yZXNwb25zZS5kYXRhLm1lc3NhZ2UsCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aXRsZTogIkVycm9yISIsCiAgICAgICAgICAgICAgYXV0b0hpZGVEZWxheTogNTAwMCwKICAgICAgICAgICAgICB0b2FzdGVyOiAiYi10b2FzdGVyLXRvcC1jZW50ZXIiLAogICAgICAgICAgICAgIHZhcmlhbnQ6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICBub0Nsb3NlQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgfQogICAgICAgICAgKTsKICAgICAgICB9KTsKICAgIH0sCiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuY29kZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmNvZGU7CiAgICBpZiAoIXRoaXMuY29kZSAmJiAhc3RhdGUudXNlci5pZCkgewogICAgICBhbGVydCgiTm90IGxvZ2dlZCBpbiBhbmQgbm8gY29kZSwgcmVkaXJlY3QgdG8gbG9naW4/Iik7CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["ChangePassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChangePassword.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div\n    class=\"h-100 d-flex flex-column justify-content-center align-items-center my-5\"\n  >\n    <form @submit.prevent=\"resetPassword\">\n      <div v-if=\"code\">\n        <img src=\"@/assets/logo-plum-and-orange.png\" />\n        <b-input-group>\n          <b-form-input\n            v-model=\"new_password\"\n            type=\"password\"\n            placeholder=\"New password here...\"\n            required\n          ></b-form-input>\n\n          <b-input-group-append>\n            <b-button variant=\"outline-secondary\" type=\"submit\"\n              >Change Password</b-button\n            >\n          </b-input-group-append>\n        </b-input-group>\n      </div>\n      <div v-else>\n        <b-form-input\n          class=\"mb-2\"\n          v-model=\"old_password\"\n          type=\"password\"\n          placeholder=\"Old password here...\"\n          required\n        ></b-form-input>\n        <b-form-input\n          class=\"mb-2\"\n          v-model=\"new_password\"\n          type=\"password\"\n          placeholder=\"New password here...\"\n          required\n        ></b-form-input>\n        <b-button variant=\"outline-secondary\" type=\"submit\"\n          >Change Password</b-button\n        >\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\n\nimport {state} from \"@/store\"\n\nexport default {\n  data: function() {\n    return {\n      code: null,\n      new_password: null,\n      old_password: null,\n    };\n  },\n  methods: {\n    resetPassword: function() {\n      if (this.code) {\n        this.resetPasswordwithCode();\n      } else {\n        this.resetPasswordwithPassword();\n      }\n    },\n    resetPasswordwithCode: function() {\n      this.$http\n        .put(`${this.$api}/reset-password`, {\n          code: this.code,\n          new_password: this.new_password,\n        })\n        .then((res) => {\n          this.$bvToast.toast(\"Password successfully reset\", {\n            title: \"Success!\",\n            autoHideDelay: 5000,\n            toaster: \"b-toaster-top-center\",\n            variant: \"info\",\n            noCloseButton: false,\n          });\n\n          setTimeout(() => {\n            this.$router.push(\"/login\");\n          }, 3000);\n        })\n        .catch((err) => {\n          this.$bvToast.toast(\n            \"Unable to reset password. Error: \" + err.response.data.message,\n            {\n              title: \"Error!\",\n              autoHideDelay: 5000,\n              toaster: \"b-toaster-top-center\",\n              variant: \"warning\",\n              noCloseButton: false,\n            }\n          );\n\n          setTimeout(() => {\n            this.$router.push(\"/\");\n          }, 3000);\n        });\n    },\n    resetPasswordwithPassword: function() {\n      this.$http\n        .put(`${this.$api}/reset-password`, {\n          previous_password: this.old_password,\n          new_password: this.new_password,\n          user_id: state.user.id,\n        })\n        .then((res) => {\n          this.new_password = null;\n          this.old_password = null;\n          this.$bvToast.toast(\"Password successfully changed.\", {\n            title: \"Success!\",\n            autoHideDelay: 5000,\n            toaster: \"b-toaster-top-center\",\n            variant: \"success\",\n            noCloseButton: false,\n          });\n        })\n        .catch((err) => {\n          this.$bvToast.toast(\n            \"Unable to reset password. Error: \" + err.response.data.message,\n            {\n              title: \"Error!\",\n              autoHideDelay: 5000,\n              toaster: \"b-toaster-top-center\",\n              variant: \"warning\",\n              noCloseButton: false,\n            }\n          );\n        });\n    },\n  },\n  mounted: function() {\n    this.code = this.$route.query.code;\n    if (!this.code && !state.user.id) {\n      alert(\"Not logged in and no code, redirect to login?\");\n    }\n  },\n};\n</script>\n\n<style></style>\n"]}]}